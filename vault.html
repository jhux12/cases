<!DOCTYPE html>
<html lang="en" class="overflow-x-hidden">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Packly.gg | Vault</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="scripts/firebase-config.js"></script>
  <link rel="stylesheet" href="styles/main.css" />
  <style>
    .clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
  <style>
    .flip-card { perspective:1000px; cursor:pointer; transition:transform .3s; }
    .flip-card-inner { position:relative; width:160px; height:160px; transform-style:preserve-3d; transition:transform .6s; }
    .flip-card.flipped .flip-card-inner { transform:rotateY(180deg); }
    .flip-card-front, .flip-card-back { position:absolute; width:100%; height:100%; backface-visibility:hidden; border-radius:0.75rem; }
    .flip-card-front { transform:rotateY(180deg); }
    .flip-card:hover { transform:scale(1.05); }
    @media (max-width: 640px) {
      .flip-card-inner { width:120px; height:120px; }
    }
  </style>
    <style>
      @keyframes win-glow {
        0%, 100% { box-shadow: 0 0 0 rgba(255,215,0,0.4); }
        50% { box-shadow: 0 0 20px rgba(255,215,0,0.9); }
      }
      .flip-card.selected { animation: win-glow 1s ease-in-out; }
    </style>
    <style>
      .legendary-spark{overflow:visible;}
      .legendary-spark::before,
      .legendary-spark::after{
        content:'';
        position:absolute;
        top:50%;
        left:50%;
        width:6px;
        height:6px;
        background:radial-gradient(circle, rgba(250,204,21,1) 0%, rgba(250,204,21,0) 70%);
        border-radius:50%;
        pointer-events:none;
        animation:spark-burst 0.8s linear infinite;
      }
      .legendary-spark::after{animation-delay:0.4s;}
      @keyframes spark-burst{
        0%{transform:translate(-50%,-50%) scale(1);opacity:1;}
        100%{transform:translate(calc(-50% + var(--sx)),calc(-50% + var(--sy))) scale(0.2);opacity:0;}
      }
      .legendary-spark::before{--sx:-30px;--sy:-30px;}
      .legendary-spark::after{--sx:30px;--sy:-30px;}
    </style>
  </head>
  <body class="min-h-screen bg-gray-50 text-gray-900 overflow-x-hidden">
<script src="scripts/preloader.js"></script>
  <header></header>

  <section id="pack-section" class="relative pt-32 pb-10 px-4">
    <div class="relative z-10 mb-6">
      <div class="flex items-center justify-between px-4 py-2 bg-white rounded-full shadow border border-gray-200">
        <a id="back-btn" href="index.html" class="flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 text-white hover:scale-110 transition-transform" aria-label="Back to packs">
          <i class="fas fa-arrow-left"></i>
        </a>
        <h2 id="pack-name" class="flex-1 text-center text-xl sm:text-2xl font-bold mx-4 gradient-text leading-none">Loading...</h2>
      </div>
      <div id="case-spice" class="text-center text-xs mt-2"></div>
    </div>

    <div id="pack-display" class="flex flex-col items-center gap-4 mt-6">
      <div class="relative w-28 h-28 sm:w-40 sm:h-40">
        <img id="top-card-1" class="hidden absolute z-0 -left-8 sm:-left-10 top-1/2 w-16 h-24 sm:w-20 sm:h-28 object-contain rounded-lg bg-white border-2 shadow-lg transform -translate-y-1/2 -rotate-12" />
        <img id="top-card-2" class="hidden absolute z-0 -right-8 sm:-right-10 top-1/2 w-16 h-24 sm:w-20 sm:h-28 object-contain rounded-lg bg-white border-2 shadow-lg transform -translate-y-1/2 rotate-12" />
        <img id="main-pack-image" class="relative z-10 w-full h-full object-contain" alt="Pack" />
      </div>
      <button id="open-pack" class="shining-button animate-pulse relative px-6 py-3 rounded-full bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-500 text-white font-extrabold flex items-center justify-center gap-2 shadow-lg transition-transform hover:scale-105 focus:outline-none overflow-hidden">
        <span class="relative z-10 flex items-center gap-2">
          Open for
          <img src="https://firebasestorage.googleapis.com/v0/b/cases-e5b4e.firebasestorage.app/o/diamond.png?alt=media&token=244f4b80-1832-4c7c-89da-747a1f8457ff" class="w-5 h-5" />
          <span id="pack-price">...</span>
        </span>
      </button>
      <div class="flex justify-center mt-2">
        <button id="pf-info" class="flex items-center gap-2 text-sm font-semibold text-green-600 hover:text-green-500 transition cursor-pointer">
          <i class="fa-solid fa-shield-halved text-green-600 text-base drop-shadow"></i>
          <span>Provably Fair</span>
        </button>
      </div>
    </div>

    <div id="card-container" class="hidden flex flex-wrap justify-center gap-2 sm:gap-4 mt-10"></div>

    <div class="bg-white rounded-2xl shadow-md border border-gray-200 p-6 transition-all duration-300 mt-10 relative">
      <img class="case-pack-image absolute -top-10 left-0 -translate-x-1/2 w-64 opacity-20 z-0 pointer-events-none -rotate-12" alt="Pack Art" />
      <img class="case-pack-image absolute -top-10 right-0 translate-x-1/2 w-64 opacity-20 z-0 pointer-events-none rotate-12" alt="Pack Art" />
      <div class="relative z-10">
        <div class="text-center mb-6">
          <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-500 shadow-md">
            <img src="https://cdn-icons-png.flaticon.com/128/5172/5172637.png" alt="Rewards Icon" class="w-5 h-5" />
            <span class="text-sm font-bold uppercase tracking-wider text-white">Rewards Table</span>
          </div>
          <p class="mt-2 text-sm text-gray-600">Each pack contains a mix of prizes with different rarities and values.</p>
        </div>
        <div id="prizes-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-4 sm:gap-6 text-sm"></div>
      </div>
    </div>
  </section>

  <div id="win-popup" class="fixed inset-0 bg-black/80 backdrop-blur-sm hidden flex items-center justify-center z-50">
    <div id="popup-card" class="premium-popup popup-box border rounded-2xl p-6 w-full max-w-sm text-center relative bg-white text-gray-900">
      <button id="close-popup" class="absolute top-2 right-3 text-gray-500 hover:text-gray-700 text-xl">&times;</button>
      <img id="popup-image" src="" alt="Prize" class="w-48 h-48 object-contain mx-auto mb-4 rounded-lg premium-glow" />
      <h3 id="popup-name" class="text-lg font-semibold mb-1"></h3>
      <div id="popup-rarity" class="text-xs uppercase tracking-wider mb-1"></div>
      <div class="text-yellow-600 font-bold mb-1"><span id="popup-value"></span> gems</div>
      <div class="text-gray-600 text-xs mb-4"><span id="popup-odds"></span> chance</div>
      <div class="flex justify-center gap-4">
        <button id="keep-btn" class="px-4 py-2 rounded-xl premium-button text-sm">Keep</button>
        <button id="sell-btn" class="px-4 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm font-bold">Sell for <span id="sell-value"></span></button>
      </div>
    </div>
  </div>

  <!-- Provably Fair Modal -->
  <div id="provably-fair-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
    <div class="bg-white p-4 rounded-xl w-full max-w-sm text-gray-900 relative border border-gray-200">
      <button onclick="document.getElementById('provably-fair-modal').classList.add('hidden')" class="absolute top-2 right-3 text-gray-500 text-xl">&times;</button>
      <h3 class="text-lg font-bold mb-3">Provably Fair</h3>
      <p class="text-xs text-gray-600 mb-4">All outcomes are generated using your client seed, our server seed, and a nonce. The resulting roll is compared against the case odds to decide the prize, ensuring every spin is fair and verifiable.</p>
      <div class="text-left text-xs space-y-2 font-mono text-gray-800 break-words">
        <div><strong>Server Seed:</strong> <span id="pf-server-seed">...</span></div>
        <div><strong>Client Seed:</strong> <span id="pf-client-seed">...</span></div>
        <div><strong>Nonce:</strong> <span id="pf-nonce">...</span></div>
      </div>
      <div class="mt-4 space-y-2 text-xs">
        <input id="client-seed-input" type="text" placeholder="New client seed" class="w-full px-2 py-1 rounded bg-gray-100 text-gray-900" />
        <button id="update-client-seed" class="w-full bg-green-600 hover:bg-green-500 rounded py-2 text-white">Update Client Seed</button>
        <button id="new-server-seed" class="w-full bg-purple-600 hover:bg-purple-500 rounded py-2 text-white">New Server Seed</button>
        <a href="verify.html" class="block text-center text-blue-600 hover:underline mt-2">Verify a roll</a>
      </div>
    </div>
  </div>

  <footer></footer>

  <script src="scripts/header.js"></script>
  <script src="scripts/footer.js"></script>
  <script src="scripts/navbar.js"></script>
  <script src="scripts/topup.js"></script>
  <script src="scripts/vault.js"></script>
</body>
</html>

